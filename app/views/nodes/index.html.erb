<%= body_class "node-type-nodes" %>

<div class="row">
  <div class="span12">
    <div class="node-type-header">
      <div class="row">
        <div class="span7">
          <%= page_title @node_type.name %>
        </div>
        <div class="span5 node-type-actions">
          <% if @node_type.signin_required? %>
            <%= link_to new_node_type_node_path(@node_type),
                        class: "btn btn-primary disabled btn-new-node",
                        rel: "tooltip",
                        data: {
                          placement: "bottom",
                          original_title: "Node ekleyebilmek icin kullanici girisi yapiniz."
                        } do %>
              <%= content_tag :i, nil, class: "icon-plus icon-white" %>
              add new node
            <% end %>
          <% else %>
            <%= link_to new_node_type_node_path(@node_type),
                        class: "btn btn-primary btn-new-node",
                        rel: "tooltip",
                        data: {
                          placement: "bottom",
                          original_title: "Ücretsiz ve üyelik gerektirmez. Sadece email adresiniz yeterli."
                        } do %>
              <%= content_tag :i, nil, class: "icon-plus icon-white" %>
              add new node
            <% end %>

          <% end %>
          <%= dropdown "related node types", class: "btn-inverse" do %>
            <% @node_type.related_node_types.each do |nt| %>
              <li><%= link_to nt.name, node_type_nodes_path(nt) %></li>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<% view = Views::CustomPageView.new(
  params.clone,
  @node_type,
  @nodes,
  self)
%>

<% if @node_type.filters_position == :left %>
  <div class="row">
    <% unless @node_type.filter_configs.blank? %>
      <div class="span3">
        <div class="controls">
          <h3 class="control-title">FILTERS</h3>
        </div>
        <%= render 'nodes/filters_left_side/filter_form' %>
      </div>
    <% end %>

    <div class="<%= @node_type.filter_configs.blank? ? "span12" : "span9" %>">
      <div class="controls">
        <div class="right-sided-controls btn-group">
          <%= view.view_links %>
        </div>
        <div class="right-sided-controls btn-group">
          <%= view.sort_links %>
        </div>
        <h3 class="control-title">NODES</h3>
      </div>

      <div id="nodes">
        <%= view %>
      </div>

      <div id="paging">
        <%= view.paginate %>
      </div>
    </div>
  </div>

<% else %>

  <div class="row">
    <div class="span12 controls">
      <div class="right-sided-controls btn-group">
        <%= view.view_links %>
      </div>
      <div class="right-sided-controls btn-group">
          <%= view.sort_links %>
      </div>
      <%= render 'nodes/filters_top_side/filter_form' unless @node_type.filter_configs.blank? %>
    </div>

    <div id="nodes" class="span12">
      <%= view %>
    </div>

    <div id="paging" class="span12">
      <%= view.paginate %>
    </div>
  </div>
  
<% end %>

<!-- Custom CSS for NodeType -->
<%= view.css %>

<%= node_type_background %>

<!-- Custom JS for NodeType -->
<%= view.js %>