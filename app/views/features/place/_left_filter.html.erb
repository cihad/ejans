<% tree = feature.tree %>
<% tree.each_with_index do |level, i| %>
  <select id="<%= i %>" name="<%= feature.form_machine_names[i] %>" class="span2 single-input">
    <option value="">
      <%= feature.form_level_names[i] %>
    </option>
    <% level.each do |place| %>
      <option value="<%= place.id %>" class="<%= place.parent_place.id unless i == 0 %>" <%= "selected" if place.id.to_s == params["#{feature.form_machine_names[i]}"] %>><%= place.name %></option>
    <% end %>
  </select>
<% end %>

<% javascript 'jquery-plugins/jquery.chained' %>
<%= javascript_tag do %>
  <% (tree.count - 1).times do |i| %>
    $("#<%= i+1 %>").chained("#<%= i %>");
  <% end %>
<% end %>